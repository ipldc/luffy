package economic;

import java.net.MalformedURLException;
import java.net.URL;
import java.time.Duration;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeOptions;
import org.openqa.selenium.remote.RemoteWebDriver;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.openqa.selenium.JavascriptExecutor;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;
import utils.EventHandler;
import org.openqa.selenium.support.events.WebDriverListener;
import org.openqa.selenium.support.events.EventFiringDecorator;

public class TestEconomic {
    public static WebDriver driver;
    private WebDriverWait wait;
    public final int IMPLICIT_WAIT_TIME = 10;
    public final int PAGE_LOAD_TIME = 10;

    @BeforeMethod
    public void beforeMethod() throws MalformedURLException {
        ChromeOptions chromeOptions = new ChromeOptions();
        driver = new RemoteWebDriver(new URL("http://localhost:4444"), chromeOptions);
        driver.manage().window().maximize();
        wait = new WebDriverWait(driver, Duration.ofSeconds(20));
        driver.get("https://economictimes.indiatimes.com/et-now/results");
        WebDriverListener listener = new EventHandler();
        driver = new EventFiringDecorator<>(listener).decorate(driver);
        System.out.println("Browser initialized");
    }

    @Test
    public void economic() throws Exception {
        driver.findElement(By.xpath("//*[@id=\"topnav\"]/div[10]/a")).click();
        Thread.sleep(10000);
        JavascriptExecutor js = (JavascriptExecutor) driver;
        js.executeScript("window.scrollBy(0,600)", "");
        driver.findElement(By.id("amcSelection")).click();
        Thread.sleep(5000);
        Select amcSelect = new Select(driver.findElement(By.id("amcSelection")));
        amcSelect.selectByVisibleText("Canara Robeco");
        Thread.sleep(3000);
        driver.findElement(By.id("schemenm")).click();
        Thread.sleep(5000);
        Select schemeSelect = new Select(driver.findElement(By.id("schemenm")));
        schemeSelect.selectByVisibleText("Canara Robeco Bluechip Equity Direct-G");
        Thread.sleep(1000);

        // Handling overlay or ad
        try {
            WebElement adCloseButton = driver.findElement(By.cssSelector("div#ad_position_box")); // Adjust the selector as needed
            if (adCloseButton.isDisplayed()) {
                System.out.println("Closing the ad...");
                ((JavascriptExecutor) driver).executeScript("arguments[0].style.visibility='hidden'", adCloseButton);
            }
        } catch (Exception e) {
            System.out.println("Ad close button not found or already closed.");
        }

        // Use JavaScript to click if the standard click fails
        WebElement getDetailsButton = driver.findElement(By.id("getDetails"));
        try {
            getDetailsButton.click();
        } catch (Exception e) {
            ((JavascriptExecutor) driver).executeScript("arguments[0].click();", getDetailsButton);
        }

        Thread.sleep(15000);

        String currentTab = driver.getWindowHandle();
        for (String tab : driver.getWindowHandles()) {
            if (!tab.equals(currentTab)) {
                driver.switchTo().window(tab);
                break;
            }
        }

        WebElement dropdownContainer = driver.findElement(By.xpath("/html/body/main/div[10]/section[1]/div/div[2]/div[1]/div[2]/ul/li/span"));
        dropdownContainer.click();

        WebElement options = dropdownContainer.findElement(By.xpath("/html/body/main/div[10]/section[1]/div/div[2]/div[1]/div[2]/ul/li/ul/li[1]"));
        options.click();
        Thread.sleep(2000);
        WebElement container = driver.findElement(By.xpath("/html/body/main/div[10]/section[1]/div/div[2]/div[1]/div[3]/ul/li/span"));
        container.click();

        WebElement option = dropdownContainer.findElement(By.xpath("/html/body/main/div[10]/section[1]/div/div[2]/div[1]/div[3]/ul/li/ul/li[3]/span"));
        option.click();

        Thread.sleep(2000);

        WebElement contain = driver.findElement(By.xpath("/html/body/main/div[10]/section[1]/div/div[2]/div[1]/div[4]/ul/li/span"));
        contain.click();

        WebElement opt = dropdownContainer.findElement(By.xpath("/html/body/main/div[10]/section[1]/div/div[2]/div[1]/div[4]/ul/li/ul/li[4]/span"));
        opt.click();

        WebElement returns = driver.findElement(By.xpath("/html/body/main/div[10]/section[3]/div/ul/li[2]"));
        returns.click();
        Thread.sleep(5000);

        WebElement printthis = driver.findElement(By.xpath("/html/body/main/div[10]/section[5]/div/div[1]/section[1]/div[2]/div[2]/ul/li[1]/table/tbody/tr[1]"));
        System.out.println(printthis.getText());
    }

    @AfterMethod
    public void afterMethod() {
        driver.quit();
    }
}



Money Control:

package com.cse


import java.io.IOException;

import org.openqa.selenium.By;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;
import org.testng.annotations.Test;

public class AppTest 
{
    @Test
    public void TestLocator() throws InterruptedException, IOException
    {
        String bravePath = "C:/Users/suren/AppData/Local/BraveSoftware/Brave-Browser/Application/brave.exe";

        ChromeOptions options = new ChromeOptions();
        options.setBinary(bravePath);

        WebDriver driver = new ChromeDriver(options);

        driver.get("https://www.moneycontrol.com");

        Thread.sleep(10000);

        WebElement searchBox = driver.findElement(By.id("search_str"));
        searchBox.click();

        searchBox.sendKeys("Reliance Industries" + Keys.RETURN);

        Thread.sleep(10000);

        WebElement suggestion = driver.findElement(By.xpath("//ul[@class='suggestion-list']/li[1]/a"));
        suggestion.click();

        
        boolean isPresent = driver.getPageSource().contains("Reliance Industries Ltd.");
        System.out.println("Is 'Reliance Industries Ltd.' present on the page? " + isPresent);

        
        WebElement mutualFundsDropdown = driver.findElement(By.xpath("//a[text()='Mutual Funds']"));
        mutualFundsDropdown.click();
        WebElement sipReturnOption = driver.findElement(By.xpath("//a[text()='SIP Returns']"));
        sipReturnOption.click();

        
        WebElement selectFund = driver.findElement(By.xpath("//a[@data-name='axis-mutual-fund']"));
        selectFund.click();

        
        WebElement schemeDropdown = driver.findElement(By.xpath("//select[@id='selectScheme']"));
        schemeDropdown.sendKeys("Axis Arbitrage Fund Regular Plan (D)");

        
        WebElement investmentAmount = driver.findElement(By.id("amount"));
        investmentAmount.sendKeys("100000");

       
        WebElement sipFrequency = driver.findElement(By.xpath("//select[@id='sipTenure']/option[text()='Monthly']"));
        sipFrequency.click();

        
        WebElement startDate = driver.findElement(By.id("startDate"));
        startDate.sendKeys("2021-08-02");
        WebElement endDate = driver.findElement(By.id("endDate"));
        endDate.sendKeys("2023-08-17");

       
        WebElement calculateButton = driver.findElement(By.id("calculate"));
        calculateButton.click();

      
        WebElement investmentPeriod = driver.findElement(By.xpath("//table[@id='sip_calc_table']/tbody/tr[2]/td[2]"));
        WebElement totalAmountInvested = driver.findElement(By.xpath("//table[@id='sip_calc_table']/tbody/tr[3]/td[2]"));
        System.out.println("Investment Period: " + investmentPeriod.getText());
        System.out.println("Total Amount Invested: " + totalAmountInvested.getText());

       
        driver.quit();
        
    }
}
